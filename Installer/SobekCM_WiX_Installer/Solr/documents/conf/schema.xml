<?xml version="1.0" encoding="UTF-8" ?>
<schema name="sobekcm.documents" version="1.3">
  <types>

	  <!-- The StrField type is not analyzed, but indexed/stored verbatim. -->
    <fieldType name="string" class="solr.StrField" sortMissingLast="true" omitNorms="true"/>

    <!-- boolean type: "true" or "false" -->
    <fieldType name="boolean" class="solr.BoolField" sortMissingLast="true" omitNorms="true"/>
    
    <!--Binary data type. The data should be sent/retrieved in as Base64 encoded Strings -->
    <fieldtype name="binary" class="solr.BinaryField"/>

    <!--
      Default numeric field types. For faster range queries, consider the tint/tfloat/tlong/tdouble types.
    -->
    <fieldType name="int" class="solr.TrieIntField" precisionStep="0" omitNorms="true" positionIncrementGap="0"/>
    <fieldType name="float" class="solr.TrieFloatField" precisionStep="0" omitNorms="true" positionIncrementGap="0"/>
    <fieldType name="long" class="solr.TrieLongField" precisionStep="0" omitNorms="true" positionIncrementGap="0"/>
    <fieldType name="double" class="solr.TrieDoubleField" precisionStep="0" omitNorms="true" positionIncrementGap="0"/>

    <!--
     Numeric field types that index each value at various levels of precision
     to accelerate range queries when the number of values between the range
     endpoints is large. See the javadoc for NumericRangeQuery for internal
     implementation details.

     Smaller precisionStep values (specified in bits) will lead to more tokens
     indexed per value, slightly larger index size, and faster range queries.
     A precisionStep of 0 disables indexing at different precision levels.
    -->
    <fieldType name="tint" class="solr.TrieIntField" precisionStep="8" omitNorms="true" positionIncrementGap="0"/>
    <fieldType name="tfloat" class="solr.TrieFloatField" precisionStep="8" omitNorms="true" positionIncrementGap="0"/>
    <fieldType name="tlong" class="solr.TrieLongField" precisionStep="8" omitNorms="true" positionIncrementGap="0"/>
    <fieldType name="tdouble" class="solr.TrieDoubleField" precisionStep="8" omitNorms="true" positionIncrementGap="0"/>

    <fieldType name="date" class="solr.TrieDateField" omitNorms="true" precisionStep="0" positionIncrementGap="0"/>
    <fieldType name="tdate" class="solr.TrieDateField" omitNorms="true" precisionStep="6" positionIncrementGap="0"/>

    <!-- A text field that uses WordDelimiterFilter to enable splitting and matching of
        words on case-change, alpha numeric boundaries, and non-alphanumeric chars,
        so that a query of "wifi" or "wi fi" could match a document containing "Wi-Fi".
        Synonyms and stopwords are customized by external files, and stemming is enabled.
        The attribute autoGeneratePhraseQueries="true" (the default) causes words that get split to
        form phrase queries. For example, WordDelimiterFilter splitting text:pdp-11 will cause the parser
        to generate text:"pdp 11" rather than (text:PDP OR text:11).
        NOTE: autoGeneratePhraseQueries="true" tends to not work well for non whitespace delimited languages.
        -->
    <fieldType name="text" class="solr.TextField" positionIncrementGap="100" autoGeneratePhraseQueries="true">
      <analyzer type="index">
        <tokenizer class="solr.WhitespaceTokenizerFactory"/>
        <!-- in this example, we will only use synonyms at query time
        <filter class="solr.SynonymFilterFactory" synonyms="index_synonyms.txt" ignoreCase="true" expand="false"/>
        -->
        <!-- Case insensitive stop word removal.
          add enablePositionIncrements=true in both the index and query
          analyzers to leave a 'gap' for more accurate phrase queries.
        -->
        <filter class="solr.StopFilterFactory"
                ignoreCase="true"
                words="stopwords.txt"
                enablePositionIncrements="true"
                />
        <filter class="solr.WordDelimiterFilterFactory" generateWordParts="1" generateNumberParts="1" catenateWords="1" catenateNumbers="1" catenateAll="0" splitOnCaseChange="1"/>
        <filter class="solr.LowerCaseFilterFactory"/>
        <filter class="solr.KeywordMarkerFilterFactory" protected="protwords.txt"/>
        <filter class="solr.PorterStemFilterFactory"/>
      </analyzer>
      <analyzer type="query">
        <tokenizer class="solr.WhitespaceTokenizerFactory"/>
        <filter class="solr.SynonymFilterFactory" synonyms="synonyms.txt" ignoreCase="true" expand="true"/>
        <filter class="solr.StopFilterFactory"
                ignoreCase="true"
                words="stopwords.txt"
                enablePositionIncrements="true"
                />
        <filter class="solr.WordDelimiterFilterFactory" generateWordParts="1" generateNumberParts="1" catenateWords="0" catenateNumbers="0" catenateAll="0" splitOnCaseChange="1"/>
        <filter class="solr.LowerCaseFilterFactory"/>
        <filter class="solr.KeywordMarkerFilterFactory" protected="protwords.txt"/>
        <filter class="solr.PorterStemFilterFactory"/>
      </analyzer>
    </fieldType>



    <!-- A general unstemmed text field - good if one does not know the language of the field -->
    <fieldType name="textgen" class="solr.TextField" positionIncrementGap="100">
      <analyzer type="index">
        <tokenizer class="solr.WhitespaceTokenizerFactory"/>
        <filter class="solr.StopFilterFactory" ignoreCase="true" words="stopwords.txt" enablePositionIncrements="true" />
        <filter class="solr.WordDelimiterFilterFactory" generateWordParts="1" generateNumberParts="1" catenateWords="1" catenateNumbers="1" catenateAll="0" splitOnCaseChange="0"/>
        <filter class="solr.LowerCaseFilterFactory"/>
      </analyzer>
      <analyzer type="query">
        <tokenizer class="solr.WhitespaceTokenizerFactory"/>
        <filter class="solr.SynonymFilterFactory" synonyms="synonyms.txt" ignoreCase="true" expand="true"/>
        <filter class="solr.StopFilterFactory"
                ignoreCase="true"
                words="stopwords.txt"
                enablePositionIncrements="true"
                />
        <filter class="solr.WordDelimiterFilterFactory" generateWordParts="1" generateNumberParts="1" catenateWords="0" catenateNumbers="0" catenateAll="0" splitOnCaseChange="0"/>
        <filter class="solr.LowerCaseFilterFactory"/>
      </analyzer>
    </fieldType>


    <!-- Type used for sorting, which are not searched or stored
         Entire term is lowercased and retained as a single token.  -->
    <fieldType name="sorter" class="solr.TextField" sortMissingLast="true" omitNorms="true">
      <analyzer>
        <tokenizer class="solr.KeywordTokenizerFactory"/>
        <filter class="solr.LowerCaseFilterFactory" />
        <filter class="solr.TrimFilterFactory" />
      </analyzer>
    </fieldType>

    <!-- Type used for facets, which are not searched or stored
         Entire term is lowercased and retained as a single token.  -->
    <fieldType name="faceter" class="solr.TextField" positionIncrementGap="100">
      <analyzer>
        <tokenizer class="solr.KeywordTokenizerFactory"/>
        <filter class="solr.LowerCaseFilterFactory" />
      </analyzer>
    </fieldType>

    <fieldType name="text_path" class="solr.TextField" positionIncrementGap="100">
      <analyzer>
        <tokenizer class="solr.PathHierarchyTokenizerFactory"/>
      </analyzer>
    </fieldType>

    <!-- since fields of this type are by default not stored or indexed,
         any data added to them will be ignored outright.  --> 
    <fieldtype name="ignored" stored="false" indexed="false" multiValued="true" class="solr.StrField" />

 </types>


 <fields>

   <!-- Identification fields -->
   <field name="did" type="string" indexed="true" stored="true" required="true" /> 
   <field name="bibid" type="string" indexed="true" stored="false" /> 
   <field name="vid" type="string" indexed="true" stored="false" /> 
   <field name="url" type="string" indexed="false" stored="true" />
   
   <!-- Some basic behavior fields which may need to be returned or filtered upon -->
   <field name="iprestrictionmask" type="int" indexed="false" stored="false" />
   <field name="dark" type="boolean" indexed="false" stored="false" /> 
   
   <!-- Links to all aggregations must be present here as well -->
   <field name="aggregation_code" type="string" indexed="true" stored="false"  multiValued="true" />
   <field name="aggregations_facet" type="faceter" indexed="false" stored="false"  multiValued="true" />
   
   <!-- Fields which replace the metadata types from SQL -->
   <field name="abstract" type="text" indexed="true" stored="false"  multiValued="true" />
   <field name="affiliation" type="text" indexed="true" stored="false"  multiValued="true" />
   <field name="aleph" type="long" indexed="true" stored="true" />
   <field name="allsubjects" type="text" indexed="true" stored="false"  multiValued="true" />
   <field name="allsubjects_facet" type="faceter" indexed="true" stored="false" multiValued="true" />
   <field name="attribution" type="text" indexed="true" stored="false" />
   <field name="city" type="text" indexed="true" stored="false"  multiValued="true" />
   <field name="city_facet" type="faceter" indexed="true" stored="false" multiValued="true" />
   <field name="country" type="text" indexed="true" stored="false"  multiValued="true" />
   <field name="country_facet" type="faceter" indexed="true" stored="false" multiValued="true" />
   <field name="county" type="text" indexed="true" stored="false"  multiValued="true" />
   <field name="county_facet" type="faceter" indexed="true" stored="false" multiValued="true" />
   <field name="creator" type="text" indexed="true" stored="false"  multiValued="true" />
   <field name="creator_facet" type="faceter" indexed="true" stored="false"  multiValued="true" />
   <field name="donor" type="text" indexed="true" stored="true" />
   <field name="edition" type="text" indexed="true" stored="true" />
   <field name="format" type="text" indexed="true" stored="true" />
   <field name="frequency" type="text" indexed="true" stored="false"  multiValued="true" />
   <field name="frequency_facet" type="faceter" indexed="true" stored="false"  multiValued="true" />
   <field name="genre" type="text" indexed="true" stored="false"  multiValued="true" />
   <field name="genre_facet" type="faceter" indexed="true" stored="false"  multiValued="true" />
   <field name="holdinglocation" type="text" indexed="true" stored="true" />
   <field name="identifier" type="string" indexed="true" stored="false"  multiValued="true" />
   <field name="language" type="text" indexed="true" stored="false"  multiValued="true" />
   <field name="language_facet" type="faceter" indexed="true" stored="false"  multiValued="true" />
   <field name="maintitle" type="text" indexed="true" stored="true"/>
   <field name="maintitle_sort" type="sorter" indexed="true" stored="false"/>
   <field name="materialtype" type="string" indexed="true" stored="true" />
   <field name="materialtype_facet" type="faceter" indexed="true" stored="false" />
   <field name="mimetype" type="string" indexed="true" stored="false"  multiValued="true" />
   <field name="mimetype_facet" type="string" indexed="true" stored="false"  multiValued="true" />
   <field name="namesubject" type="text" indexed="true" stored="false"  multiValued="true" />
   <field name="namesubject_facet" type="faceter" indexed="true" stored="false"  multiValued="true" />
   <field name="notes" type="text" indexed="true" stored="false"  multiValued="true" />
   <field name="oclc" type="long" indexed="true" stored="true" />
   <field name="othercitation" type="text" indexed="true" stored="false"  multiValued="true" />
   <field name="pubdate" type="tdate" indexed="true" stored="false" />
   <field name="pubdate_display" type="text" indexed="true" stored="true" />
   <field name="publisher" type="text" indexed="true" stored="false"  multiValued="true" />
   <field name="publisher_facet" type="faceter" indexed="true" stored="false"  multiValued="true" />
   <field name="publisher_sort" type="sorter" indexed="true" stored="false"  multiValued="true" />
   <field name="pubplace" type="text" indexed="true" stored="false"  multiValued="true" />
   <field name="sourceinstitution" type="text" indexed="true" stored="true" />
   <field name="spatialcoverage" type="text" indexed="true" stored="false"  multiValued="true" />
   <field name="spatialcoverage_facet" type="faceter" indexed="true" stored="false"  multiValued="true" />
   <field name="state" type="text" indexed="true" stored="false"  multiValued="true" />
   <field name="state_facet" type="faceter" indexed="true" stored="false" multiValued="true" />
   <field name="subjectkeyword" type="text" indexed="true" stored="false"  multiValued="true" />
   <field name="subjectkeyword_facet" type="faceter" indexed="true" stored="false"  multiValued="true" />
   <field name="targetaudience" type="text" indexed="true" stored="false"  multiValued="true" />
   <field name="targetaudience_facet" type="faceter" indexed="true" stored="false"  multiValued="true" />
   <field name="temporaldecade" type="tint" indexed="true" stored="false"  multiValued="true" />
   <field name="temporalsubject" type="text" indexed="true" stored="false"  multiValued="true" />
   <field name="temporalsubject_facet" type="faceter" indexed="true" stored="false"  multiValued="true" />
   <field name="titles" type="text" indexed="true" stored="false" multiValued="true" />
   <field name="titlesubject" type="text" indexed="true" stored="true"  multiValued="true" />
   <field name="toc" type="text" indexed="true" stored="false"  multiValued="true" />
	 
   <!-- Fields for specialized support of DarwinCore zoological taxonomy -->
   <field name="zt_kingdom" type="string" indexed="true" stored="false" multiValued="true" />
   <field name="zt_kingdom_facet" type="faceter" indexed="true" stored="false" multiValued="true" />
   <field name="zt_phylum" type="string" indexed="true" stored="false" multiValued="true" />
   <field name="zt_phylum_facet" type="faceter" indexed="true" stored="false" multiValued="true" />
   <field name="zt_class" type="string" indexed="true" stored="false" multiValued="true" />
   <field name="zt_class_facet" type="faceter" indexed="true" stored="false" multiValued="true" />
   <field name="zt_order" type="string" indexed="true" stored="false" multiValued="true" />
   <field name="zt_order_facet" type="faceter" indexed="true" stored="false" multiValued="true" />
   <field name="zt_family" type="string" indexed="true" stored="false" multiValued="true" />
   <field name="zt_family_facet" type="faceter" indexed="true" stored="false" multiValued="true" />
   <field name="zt_genus" type="string" indexed="true" stored="false" multiValued="true" />
   <field name="zt_genus_facet" type="faceter" indexed="true" stored="false" multiValued="true" />
   <field name="zt_species" type="string" indexed="true" stored="false" multiValued="true" />
   <field name="zt_species_facet" type="faceter" indexed="true" stored="false" multiValued="true" />
   <field name="zt_commonname" type="text" indexed="true" stored="false" multiValued="true" />
   <field name="zt_scientificname" type="text" indexed="true" stored="false" multiValued="true" />
   <field name="zt_alltaxonomy" type="text" indexed="true" stored="false" multiValued="true" />

   <!-- Fields for specialized support of VRACore museum object identification schema -->
   <field name="culturalcontext" type="text" indexed="true" stored="false" multiValued="true" />
   <field name="inscription" type="text" indexed="true" stored="false" multiValued="true" />
   <field name="material" type="text" indexed="true" stored="false" multiValued="true" />
   <field name="material_display" type="string" indexed="false" stored="true" />
   <field name="material_facet" type="faceter" indexed="true" stored="false" multiValued="true" />
   <field name="measurements_display" type="string" indexed="false" stored="true" />
   <field name="styleperiod" type="text" indexed="true" stored="false" multiValued="true" />
   <field name="styleperiod_display" type="string" indexed="false" stored="true" />
   <field name="styleperiod_facet" type="faceter" indexed="true" stored="false" multiValued="true" />
   <field name="technique" type="text" indexed="true" stored="false" multiValued="true" />
   <field name="technique_display" type="string" indexed="false" stored="true" />
   <field name="technique_facet" type="faceter" indexed="true" stored="false" multiValued="true" />
	 
   <!-- Fields which are not directly indexed, but are used for search results  -->
   <field name="spatialkml" type="text" indexed="false" stored="true" /> 
   <field name="author_display" type="text" indexed="false" stored="true" />
   <field name="publisher_display" type="text" indexed="false" stored="true" />
   <field name="mainthumbnail" type="text" indexed="false" stored="true" />
   
   <!-- Serial hierarchy fields, used for display purposes -->
   <field name="level1text" type="string" indexed="false" stored="true" />
   <field name="level1index" type="tint" indexed="false" stored="true" />
   <field name="level2text" type="string" indexed="false" stored="true" />
   <field name="level2index" type="tint" indexed="false" stored="true" />
   <field name="level3text" type="string" indexed="false" stored="true" />
   <field name="level3index" type="tint" indexed="false" stored="true" />

   <!-- all searchable fields in one (for basic searching, implemented via copyField) -->
   <field name="allfields" type="text" indexed="true" stored="false" multiValued="true"/>

   <!-- all the text for this document -->
   <field name="fulltext" type="text" indexed="true" stored="true" termVectors="true" termPositions="true" termOffsets="true" />

   <!-- Timestamp for the date the item was added to the index  -->
   <field name="timestamp" type="date" indexed="true" stored="true" default="NOW" multiValued="false" />
      
 </fields>

 <!-- Field to use to determine and enforce document uniqueness. 
      Unless this field is marked with required="false", it will be a required field
   -->
 <uniqueKey>did</uniqueKey>

 <!-- field for the QueryParser to use when an explicit fieldname is absent -->
  <defaultSearchField>allfields</defaultSearchField>

 <!-- SolrQueryParser configuration: defaultOperator="AND|OR" -->
 <solrQueryParser defaultOperator="OR"/>

  <!-- Copy all the specific spatial coverage fields into the spatial coverage portion -->
  <copyField source="country" dest="spatialcoverage"/>
  <copyField source="state" dest="spatialcoverage"/>
  <copyField source="county" dest="spatialcoverage"/>
  <copyField source="city" dest="spatialcoverage"/>


  <!-- Copy all text indexed fields into one field for quick basic searching  -->
  <copyField source="did" dest="allfields"/>
  <copyField source="bibid" dest="allfields"/>
  <copyField source="abstract" dest="allfields"/>
  <copyField source="affiliation" dest="allfields"/>  
  <copyField source="allsubjects" dest="allfields"/>
  <copyField source="attribution" dest="allfields"/>
  <copyField source="city" dest="allfields"/>
  <copyField source="country" dest="allfields"/>
  <copyField source="county" dest="allfields"/>
  <copyField source="creator" dest="allfields"/>
  <copyField source="donor" dest="allfields"/>
  <copyField source="format" dest="allfields"/>
  <copyField source="edition" dest="allfields"/>
  <copyField source="frequency" dest="allfields"/>
  <copyField source="genre" dest="allfields"/>
  <copyField source="holdinglocation" dest="allfields"/>
  <copyField source="identifier" dest="allfields"/>  
  <copyField source="language" dest="allfields"/>
  <copyField source="materialtype" dest="allfields"/>
  <copyField source="mimetype" dest="allfields"/>
  <copyField source="namesubject" dest="allfields"/>
  <copyField source="notes" dest="allfields"/>
  <copyField source="othercitation" dest="allfields"/>
  <copyField source="pubdate_display" dest="allfields"/>
  <copyField source="publisher" dest="allfields"/>  
  <copyField source="pubplace" dest="allfields"/>
  <copyField source="sourceinstitution" dest="allfields"/>
  <copyField source="spatialcoverage" dest="allfields"/>
  <copyField source="state" dest="allfields"/>
  <copyField source="subjectkeyword" dest="allfields"/>
  <copyField source="targetaudience" dest="allfields"/>
  <copyField source="temporalsubject" dest="allfields"/>
  <copyField source="titles" dest="allfields"/>
  <copyField source="titlesubject" dest="allfields"/>
  <copyField source="toc" dest="allfields"/>
  <copyField source="maintitle" dest="allfields"/>
  <copyField source="level1text" dest="allfields"/>
  <copyField source="level2text" dest="allfields"/>
  <copyField source="level3text" dest="allfields"/>

  <!-- Use copyfield to populate facet and sort values -->
  <copyField source="allsubjects" dest="allsubjects_facet"/>
  <copyField source="city" dest="city_facet"/>
  <copyField source="country" dest="country_facet"/>
  <copyField source="county" dest="county_facet"/>
  <copyField source="creator" dest="creator_facet"/>
  <copyField source="frequency" dest="frequency_facet"/>
  <copyField source="genre" dest="genre_facet"/>
  <copyField source="language" dest="language_facet"/>
  <copyField source="maintitle" dest="maintitle_sort"/>
  <copyField source="materialtype" dest="materialtype_facet"/>
  <copyField source="mimetype" dest="mimetype_facet"/>
  <copyField source="namesubject" dest="namesubject_facet"/>
  <copyField source="publisher" dest="publisher_facet"/>
  <copyField source="publisher" dest="publisher_sort"/>
  <copyField source="spatialcoverage" dest="spatialcoverage_facet"/>
  <copyField source="state" dest="state_facet"/>
  <copyField source="subjectkeyword" dest="subjectkeyword_facet"/>
  <copyField source="targetaudience" dest="targetaudience_facet"/>
  <copyField source="temporalsubject" dest="temporalsubject_facet"/>
	
  <!-- Use copyfield for the DarwinCore zoological taxonomy -->
  <copyField source="zt_kingdom" dest="zt_kingdom_facet"/>
  <copyField source="zt_phylum" dest="zt_phylum_facet"/>
  <copyField source="zt_class" dest="zt_class_facet"/>
  <copyField source="zt_order" dest="zt_order_facet"/>
  <copyField source="zt_family" dest="zt_family_facet"/>
  <copyField source="zt_genus" dest="zt_genus_facet"/>
  <copyField source="zt_species" dest="zt_species_facet"/>
  <copyField source="zt_kingdom" dest="zt_alltaxonomy"/>
  <copyField source="zt_phylum" dest="zt_alltaxonomy"/>
  <copyField source="zt_class" dest="zt_alltaxonomy"/>
  <copyField source="zt_order" dest="zt_alltaxonomy"/>
  <copyField source="zt_family" dest="zt_alltaxonomy"/>
  <copyField source="zt_genus" dest="zt_alltaxonomy"/>
  <copyField source="zt_species" dest="zt_alltaxonomy"/>
  <copyField source="zt_commonname" dest="zt_alltaxonomy"/>
  <copyField source="zt_scientificname" dest="zt_alltaxonomy"/>
  <copyField source="zt_kingdom" dest="allfields"/>
  <copyField source="zt_phylum" dest="allfields"/>
  <copyField source="zt_class" dest="allfields"/>
  <copyField source="zt_order" dest="allfields"/>
  <copyField source="zt_family" dest="allfields"/>
  <copyField source="zt_genus" dest="allfields"/>
  <copyField source="zt_species" dest="allfields"/>
  <copyField source="zt_commonname" dest="allfields"/>
  <copyField source="zt_scientificname" dest="allfields"/>

  <!-- Use copyfield for the DarwinCore zoological taxonomy -->
  <copyField source="material" dest="material_facet"/>
  <copyField source="styleperiod" dest="styleperiod_facet"/>
  <copyField source="technique" dest="technique_facet"/>
  <copyField source="culturalcontext" dest="notes"/>
  <copyField source="inscription" dest="notes"/>
  <copyField source="culturalcontext" dest="allfields"/>
  <copyField source="inscription" dest="allfields"/>
  <copyField source="material" dest="allfields"/>
  <copyField source="styleperiod" dest="allfields"/>
  <copyField source="technique" dest="allfields"/>

</schema>
